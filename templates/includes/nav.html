{% load static %}
<nav class="bg-cream-50/90 dark:bg-sage-900/90 backdrop-blur-md shadow-lg border-b border-sage-200 dark:border-sage-700 sticky top-0 z-40 transition-all duration-300">
    <div class="container mx-auto px-6 py-5">
        <div class="flex items-center justify-between gap-4">
            <a class="flex items-center text-sage-700 dark:text-cream-100 font-serif font-semibold text-3xl hover:text-sage-600 dark:hover:text-cream-200 transition-colors group" href="{% url 'home' %}">
                <img src="{% static 'VictoLogo.jpg' %}" alt="Victo Logo" class="w-8 h-8 mr-3 rounded-full object-cover" />
                <span class="bg-gradient-to-r from-sage-800 to-sage-500 dark:from-cream-200 dark:to-cream-100 bg-clip-text text-transparent">C'29</span>
            </a>
            <div class="flex items-center gap-3 md:hidden">
                <button type="button" class="inline-flex items-center justify-center rounded-full border border-sage-200 dark:border-sage-700 p-2 text-sage-700 dark:text-cream-100" data-nav-toggle aria-controls="mobile-nav-panel" aria-expanded="false" aria-label="Toggle navigation">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7h16M4 12h16M4 17h16" />
                    </svg>
                </button>
            </div>
            <div class="hidden md:flex flex-grow items-center justify-end gap-2">
                <ul class="flex flex-col md:flex-row md:space-x-3 items-center">
                    {% if is_auth %}
                        {% if committees %}
                        <li class="relative mb-2 md:mb-0 group">
                            <button type="button" aria-haspopup="true" class="flex items-center text-sage-700 dark:text-cream-200 font-medium rounded-full px-5 py-2.5 border-2 border-transparent hover:bg-sage-50 dark:hover:bg-sage-800 hover:text-sage-800 dark:hover:text-cream-100 transition-all duration-300 focus:outline-none focus-visible:ring-2 focus-visible:ring-sage-400/70">
                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7l-4 4-4-4m8 6l-4 4-4-4" />
                                </svg>
                                Committees
                                <svg class="w-4 h-4 ml-2 transition-transform duration-300 group-hover:rotate-180 group-focus-within:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                                </svg>
                            </button>
                            <div role="menu" class="pointer-events-none absolute left-0 top-full mt-3 min-w-[18rem] rounded-3xl border border-sage-200/70 dark:border-sage-700/70 bg-cream-50/95 dark:bg-sage-900/95 shadow-2xl ring-1 ring-sage-100/60 dark:ring-sage-800/60 opacity-0 scale-95 transform transition-all duration-200 group-hover:pointer-events-auto group-hover:opacity-100 group-hover:scale-100 group-focus-within:pointer-events-auto group-focus-within:opacity-100 group-focus-within:scale-100">
                                <div class="py-3">
                                    {% for item in committees %}
                                    <a role="menuitem" href="{% url 'committee' item.key %}" class="block px-5 py-3 transition-all duration-200 hover:bg-sage-100/70 dark:hover:bg-sage-800/60 rounded-2xl">
                                        <div class="flex items-center justify-between text-sm font-semibold text-sage-700 dark:text-cream-100">
                                            <span>{{ item.name }}</span>
                                            {% if committee and committee.key == item.key %}
                                            <span class="text-xs font-medium text-sage-500 dark:text-sage-300">Active</span>
                                            {% endif %}
                                        </div>
                                        <p class="mt-1 text-xs text-sage-500 dark:text-sage-400 leading-snug">{{ item.summary }}</p>
                                    </a>
                                    {% endfor %}
                                </div>
                            </div>
                        </li>
                        {% endif %}
                        <li class="mb-2 md:mb-0">
                            <a class="flex items-center bg-gradient-to-r from-sage-700 to-sage-900 dark:from-sage-500 dark:to-sage-600 text-white rounded-full px-5 py-2.5 font-medium shadow-md hover:shadow-xl hover:scale-105 transition-all duration-300" href="{% url 'posts' %}">
                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />
                                </svg>
                                Union Updates
                            </a>
                        </li>
                        <li class="mb-2 md:mb-0">
                            <a class="flex items-center text-sage-700 dark:text-cream-200 font-medium rounded-full px-5 py-2.5 border-2 border-sage-300 dark:border-sage-600 hover:bg-sage-50 dark:hover:bg-sage-800 hover:border-sage-400 dark:hover:border-sage-500 hover:scale-105 transition-all duration-300" href="{% url 'videos' %}">
                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
                                </svg>
                                Media Library
                            </a>
                        </li>
                        {% if is_admin %}
                        <li class="relative mb-2 md:mb-0 group">
                            <button type="button" aria-haspopup="true" class="flex items-center text-sage-700 dark:text-cream-200 font-medium rounded-full px-5 py-2.5 border-2 border-transparent hover:bg-sage-50 dark:hover:bg-sage-800 hover:text-sage-800 dark:hover:text-cream-100 transition-all duration-300 focus:outline-none focus-visible:ring-2 focus-visible:ring-sage-400/70">
                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7l-4 4-4-4m8 6l-4 4-4-4" />
                                </svg>
                                Admin Console
                                <svg class="w-4 h-4 ml-2 transition-transform duration-300 group-hover:rotate-180 group-focus-within:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                                </svg>
                            </button>
                            <div role="menu" class="pointer-events-none absolute left-0 top-full mt-3 min-w-[17rem] rounded-3xl border border-sage-200/70 dark:border-sage-700/70 bg-cream-50/95 dark:bg-sage-900/95 shadow-2xl ring-1 ring-sage-100/60 dark:ring-sage-800/60 opacity-0 scale-95 transform transition-all duration-200 group-hover:pointer-events-auto group-hover:opacity-100 group-hover:scale-100 group-focus-within:pointer-events-auto group-focus-within:opacity-100 group-focus-within:scale-100">
                                <div class="py-3">
                                    <a role="menuitem" href="{% url 'admin_hub' %}" class="block px-5 py-3 transition-all duration-200 hover:bg-sage-100/70 dark:hover:bg-sage-800/60 rounded-2xl">
                                        <div class="flex items-center text-sm font-semibold text-sage-700 dark:text-cream-100 gap-2">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7h18M3 12h18M3 17h18" />
                                            </svg>
                                            Executive Hub
                                        </div>
                                        <p class="mt-1 text-xs text-sage-500 dark:text-sage-400 leading-snug">Coordinate tasks, chat, and rapid updates with council leads.</p>
                                    </a>
                                    <a role="menuitem" href="{% url 'post_create' %}" class="block px-5 py-3 transition-all duration-200 hover:bg-sage-100/70 dark:hover:bg-sage-800/60 rounded-2xl">
                                        <div class="flex items-center text-sm font-semibold text-sage-700 dark:text-cream-100 gap-2">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 20h9" />
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16.5 3.5a2.121 2.121 0 113 3L7 19l-4 1 1-4L16.5 3.5z" />
                                            </svg>
                                            Publish Update
                                        </div>
                                        <p class="mt-1 text-xs text-sage-500 dark:text-sage-400 leading-snug">Announce motions, minutes, and outcomes to the cohort.</p>
                                    </a>
                                    <a role="menuitem" href="{% url 'video_create' %}" class="block px-5 py-3 transition-all duration-200 hover:bg-sage-100/70 dark:hover:bg-sage-800/60 rounded-2xl">
                                        <div class="flex items-center text-sm font-semibold text-sage-700 dark:text-cream-100 gap-2">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
                                            </svg>
                                            Submit Media
                                        </div>
                                        <p class="mt-1 text-xs text-sage-500 dark:text-sage-400 leading-snug">Share highlight reels, recaps, and creative assets.</p>
                                    </a>
                                </div>
                            </div>
                        </li>
                        {% endif %}
                        <li>
                            <form method="post" action="{% url 'logout' %}">
                                {% csrf_token %}
                                <button class="flex items-center text-sage-600 dark:text-sage-400 font-medium rounded-full px-5 py-2.5 border-2 border-sage-200 dark:border-sage-700 hover:bg-sage-50 dark:hover:bg-sage-800 hover:text-sage-700 dark:hover:text-sage-300 hover:scale-105 transition-all duration-300">
                                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                                    </svg>
                                    Logout
                                </button>
                            </form>
                        </li>
                    {% else %}
                        <li>
                            <a class="flex items-center bg-gradient-to-r from-sage-700 to-sage-900 dark:from-sage-500 dark:to-sage-600 text-white font-medium rounded-full px-5 py-2.5 shadow-md hover:shadow-xl hover:scale-105 transition-all duration-300" href="{% url 'login' %}">
                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1" />
                                </svg>
                                Sign In
                            </a>
                        </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </div>
    <div id="mobile-nav-panel" class="mobile-nav-panel" aria-hidden="true" data-open="false">
        <div class="mobile-nav-sheet">
            <div class="flex items-center justify-between">
                <p class="text-sm uppercase tracking-[0.35em]">Menu</p>
                <button type="button" class="inline-flex items-center justify-center rounded-full border border-sage-200 dark:border-sage-700 p-2" data-nav-close aria-label="Close navigation">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="mobile-nav-actions">
                <a href="{% url 'home' %}" class="mobile-nav-link">
                    Home
                    <span>&#10132;</span>
                </a>
                <a href="{% url 'posts' %}" class="mobile-nav-link">Union Updates</a>
                <a href="{% url 'videos' %}" class="mobile-nav-link">Media Library</a>
                <a href="{% url 'legacy' %}" class="mobile-nav-link">Legacy</a>
                {% if is_auth and committees %}
                <details class="mobile-nav-accordion">
                    <summary>
                        Committees
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </summary>
                    <div class="mb-2">
                        {% for item in committees %}
                        <a href="{% url 'committee' item.key %}" class="hover:bg-sage-100/60 dark:hover:bg-sage-800/40">
                            <p class="text-sm font-semibold">{{ item.name }}</p>
                            <p class="text-xs text-sage-500 dark:text-sage-400">{{ item.summary }}</p>
                        </a>
                        {% endfor %}
                    </div>
                </details>
                {% endif %}
                {% if is_admin %}
                <details class="mobile-nav-accordion">
                    <summary>
                        Admin Console
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </summary>
                    <div class="mb-2">
                        <a href="{% url 'admin_hub' %}" class="hover:bg-sage-100/60 dark:hover:bg-sage-800/40">Executive Hub</a>
                        <a href="{% url 'post_create' %}" class="hover:bg-sage-100/60 dark:hover:bg-sage-800/40">Publish Update</a>
                        <a href="{% url 'video_create' %}" class="hover:bg-sage-100/60 dark:hover:bg-sage-800/40">Submit Media</a>
                    </div>
                </details>
                {% endif %}
                {% if is_auth %}
                <form method="post" action="{% url 'logout' %}">
                    {% csrf_token %}
                    <button type="submit" class="w-full inline-flex items-center justify-center rounded-full bg-gradient-to-r from-sage-700 to-sage-900 text-white px-4 py-2.5 font-semibold shadow">
                        Logout
                    </button>
                </form>
                {% else %}
                <a href="{% url 'login' %}" class="w-full inline-flex items-center justify-center rounded-full bg-gradient-to-r from-sage-700 to-sage-900 text-white px-4 py-2.5 font-semibold shadow">
                    Sign In
                </a>
                {% endif %}
            </div>
        </div>
    </div>
</nav>

<script>
(function () {
    const panel = document.getElementById('mobile-nav-panel');
    if (!panel) {
        return;
    }
    const toggles = document.querySelectorAll('[data-nav-toggle]');
    const closeButtons = panel.querySelectorAll('[data-nav-close]');
    const setState = (open) => {
        panel.dataset.open = open ? 'true' : 'false';
        document.body.classList.toggle('nav-drawer-open', open);
        toggles.forEach((btn) => btn.setAttribute('aria-expanded', open ? 'true' : 'false'));
    };
    toggles.forEach((btn) => {
        btn.addEventListener('click', () => {
            const next = panel.dataset.open !== 'true';
            setState(next);
            if (next) {
                panel.querySelector('a, button, summary')?.focus({ preventScroll: true });
            }
        });
    });
    closeButtons.forEach((btn) => btn.addEventListener('click', () => setState(false)));
    panel.addEventListener('click', (event) => {
        if (event.target === panel) {
            setState(false);
        }
    });
    document.addEventListener('keydown', (event) => {
        if (event.key === 'Escape' && panel.dataset.open === 'true') {
            setState(false);
        }
    });
})();
</script>
</nav>
